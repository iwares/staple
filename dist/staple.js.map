{"version":3,"sources":["core/application.js","core/aside.js","core/dialog.js","core/html-parser.js","core/interaction.js","core/nls.js","core/periodical-task.js","core/popup.js","core/snippets.js","core/task-manager.js","core/task.js","core/toast.js","core/uuid.js","core/noumenon.js"],"names":["define","require","exports","module","TaskManager","default","browserFeatureCheckers","sessionStorage","storage","window","key","value","setItem","result","getItem","removeItem","e","localStorage","historyManagement","h","history","pushState","replaceState","requiredBrowserFeatures","_ref","Symbol","$attrs","$temps","Preferences","_classCallCheck","this","load","_createClass","json","data","JSON","parse","stringify","get","Application","sharedInstance","Error","Object","defineProperty","method","apply","Array","prototype","slice","call","arguments","constructor","name","create","notifySuperCalled","invokeMethodAndEnsureSuperCalled","resume","taskManager","pause","state","saveState","saveApplicationState","title","document","retiree","length","go","close","destroy","features","alert","namespace","feature","list","checked","i","checker","push","home","interaction","task","extra","location","attrs","meta","head","split","concat","checkBrowserFeatures","onBrowserFeaturesNotSupport","url","origin","pathname","back","hash","undefined","loadThenDeleteApplicationState","startTask","restoreState","addEventListener","handlePopState","bind","handleHashChange","handleUnload","handleBackPressed","shared","PeriodicalTask","HTMLParser","Aside","gravity","content","_this","frame","createElement","classList","add","setContent","overlayManager","outsideTouchHandler","dismiss","attachOutsideTouchHandler","detachOutsideTouchHandler","removeEventListener","fadeinTask","run","root","attachTask","detachTask","detach","showing","toString","elements","HTMLElement","evt","stopPropagation","innerHTML","appendChild","selector","$A","querySelectorAll","querySelector","attach","darken","start","stop","remove","lighten","Dialog","_this2","cancelable","cancelOnTouchOutside","cancel","eventName","listener","dispatchToListener","open","onBackPressed","factroy","html","child","children","_ref2","OverlayManager","panel","id","updater","darkness","body","removeChild","childElementCount","overlay","target","lastElementChild","previousElementSibling","Interaction","$peeker","context","_this3","active","tasks","creating","onclick","event","handler","getAttribute","preventDefault","parentElement","onRestoreInstanceState","onTitleChanged","getTitle","request","onSaveInstanceState","finish","finishInteraction","uuid","parent","startInteraction","application","resultCode","resultData","getPreferences","dataset","reslovedTitle","runnable","ms","repeat","Number","isInteger","set","setTitle","NLSBundleLoader","bundle","languages","onload","onMasterLoaded","master","parts","needed","names","language","toLowerCase","_typeof","onPartsLoaded","source","@name","prop","config","isBuild","navigator","customizedLanguage","lang","unique","map","sequence","tid","restart","clearInterval","clearTimeout","startFunc","setInterval","setTimeout","Popup","_this4","adjustPopupPosition","x","y","pg","ox","oy","pgstrs","replace","offsetWidth","offsetHeight","style","left","top","anchor","tx","ty","ag","arect","getBoundingClientRect","agstrs","right","bottom","showAtLocation","SnippetsLoader","path","text","error","_this5","xhr","XMLHttpRequest","toUrl","onreadystatechange","readyState","status","onHTMLNotLoaded","onHTMLLoaded","send","matches","responseText","match","onNLSResolved","nlsphs","namemap","pair","substr","onNLSLoaded","notifyError","bundles","nlsph","el","snippets","els","tagName","type","trim","Task","UUID","indicator","loading","interrupter","busy","backgroundColor","workspace","temp","findByName","maxTaskCount","paused","staple","onTaskActivated","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","next","done","err","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","taskStates","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","taskState","onTaskStarted","randomUUID","isTop","onTaskFinished","onLastTaskFinished","interactions","zIndex","classes","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","manager","desktop","prefix","vendor","Webkit","Moz","O","contexts","findByUUID","previous","instances","maxInstanceCount","performSaveInstanceState","setBusy","instantiateActivedInteraction","performStartInteraction","performFinishInteraction","setLoading","requestCode","pendingResults","excess","animation","finishTask","doInteractionCreated","doInteractionClassLoaded","clazz","performRestoreInstanceState","EASINGI","EASINGO","upper","lower","outer","ueasing","leasing","uanim","lanim","anim","insertBefore","results","externalResult","evalJSON","r","onInteractionResult","upperCss","lowerCss","cssText","onAnimationComplete","Toast","duration","_this6","fadeoutTask","dismissTask","_this7","show","CHARS","chars","rnd","Math","random","join","args","search","bust","fields","field","kv","decodeURIComponent","tag","metaTags","Date","getTime","mainScript","scriptPath","main","base","stapleRoot","lastIndexOf","requirejs","baseUrl","urlArgs","waitSeconds","paths","subclass","baseclass","BaseClass"],"mappings":"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","file":"staple.js","sourcesContent":["/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/application.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple application.\ndefine('staple/application', function (require, exports, module) {\n\n\tconst TaskManager = require('staple/task-manager').default;\n\n\tconst browserFeatureCheckers = {\n\n\t\tsessionStorage : function () {\n\t\t\tlet storage = window.sessionStorage;\n\t\t\tif (!storage)\n\t\t\t\treturn false;\n\t\t\ttry {\n\t\t\t\tlet [key, value] = ['staple:///test/staple', 'staple'];\n\t\t\t\tstorage.setItem(key, value);\n\t\t\t\tlet result = (value === storage.getItem(key));\n\t\t\t\tstorage.removeItem(key);\n\t\t\t\treturn result;\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tlocalStorage : function () {\n\t\t\tlet storage = window.localStorage;\n\t\t\tif (!storage)\n\t\t\t\treturn false;\n\t\t\ttry {\n\t\t\t\tlet [key, value] = ['staple:///test/staple', 'staple'];\n\t\t\t\tstorage.setItem(key, value);\n\t\t\t\tlet result = (value === storage.getItem(key));\n\t\t\t\tstorage.removeItem(key);\n\t\t\t\treturn result;\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\thistoryManagement : function () {\n\t\t\tlet h = window.history;\n\t\t\treturn typeof(h.pushState) === 'function' && typeof(h.replaceState) === 'function';\n\t\t},\n\n\t};\n\n\tconst requiredBrowserFeatures = ['sessionStorage'];\n\n\tconst [$attrs, $temps] = [Symbol(), Symbol()];\n\n\tclass Preferences {\n\n\t\tconstructor (key) {\n\t\t\tthis[$attrs] = {key: key};\n\t\t\tthis.load();\n\t\t}\n\n\t\tload () {\n\t\t\tlet json = localStorage.getItem(this[$attrs].key) || '{}';\n\t\t\tthis[$attrs].data = JSON.parse(json);\n\t\t\treturn this;\n\t\t}\n\n\t\tput (key, value) {\n\t\t\tthis[$attrs].data[key] = value;\n\t\t\treturn this;\n\t\t}\n\n\t\tget (key) {\n\t\t\treturn this[$attrs].data[key];\n\t\t}\n\n\t\tclear () {\n\t\t\tthis[$attrs].data = {};\n\t\t\treturn this;\n\t\t}\n\n\t\tget raw () {\n\t\t\treturn this[$attrs].data;\n\t\t}\n\n\t\tcommit () {\n\t\t\tlet json = JSON.stringify(this[$attrs].data)\n\t\t\tlocalStorage.setItem(this[$attrs].key, json);\n\t\t}\n\n\t}\n\n\tclass Application {\n\n\t\tconstructor () {\n\t\t\tif (Application.sharedInstance)\n\t\t\t\tthrow new Error('Instance of Application already exist.');\n\t\t\tObject.defineProperty(Application, \"sharedInstance\", {value: this});\n\t\t\tthis[$attrs] = {};\n\t\t\tthis[$temps] = {};\n\t\t}\n\n\t\tinvokeMethodAndEnsureSuperCalled (method) {\n\t\t\tthis[$temps][method] = false;\n\t\t\tlet result = this[method].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\tif (this[$temps][method] != method)\n\t\t\t\tthrow new Error('super.' + method + '() not called in ' + this.constructor.name + '.' + method + '()');\n\t\t\tdelete this[$temps][method];\n\t\t\treturn result;\n\t\t}\n\n\t\tnotifySuperCalled (method) {\n\t\t\tthis[$temps][method] = method;\n\t\t}\n\n\t\tonCreate () {\n\t\t\tlet taskManager = TaskManager.sharedInstance;\n\t\t\ttaskManager.create();\n\t\t\tthis.notifySuperCalled('onCreate');\n\t\t}\n\n\t\tresume () {\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onResume');\n\t\t}\n\n\t\tonResume () {\n\t\t\tlet taskManager = TaskManager.sharedInstance;\n\t\t\ttaskManager.resume();\n\t\t\tthis.notifySuperCalled('onResume');\n\t\t}\n\n\t\tpause () {\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onPause');\n\t\t}\n\n\t\tonPause () {\n\t\t\tlet taskManager = TaskManager.sharedInstance;\n\t\t\ttaskManager.pause();\n\t\t\tlet state = {};\n\t\t\tstate.taskManager = taskManager.saveState();\n\t\t\tthis.saveApplicationState(state);\n\t\t\tthis.notifySuperCalled('onPause');\n\t\t}\n\n\t\tonTitleChanged (title) {\n\t\t\twindow.document.title = title;\n\t\t}\n\n\t\tonTaskStarted (name) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tonTaskActivated (name, retiree) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tonTaskFinished (name) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tonLastTaskFinished () {\n\t\t\tlet history = window.history;\n\t\t\tif (history.length > 2) {\n\t\t\t\thistory.go(-2);\n\t\t\t} else {\n\t\t\t\twindow.close();\n\t\t\t}\n\t\t}\n\n\t\tonDestroy () {\n\t\t\tlet taskManager = TaskManager.sharedInstance;\n\t\t\ttaskManager.destroy();\n\t\t\tthis.notifySuperCalled('onDestroy');\n\t\t}\n\n\t\tonBrowserFeaturesNotSupport (features) {\n\t\t\talert('Browser Features Not Support:\\n' + JSON.stringify(features));\n\t\t\t// Do not continue by default.\n\t\t\treturn false;\n\t\t}\n\n\t\tloadThenDeleteApplicationState () {\n\t\t\tlet key = 'staple://' + this.namespace + '/imstate';\n\t\t\tlet json = sessionStorage[key];\n\t\t\tif (!json)\n\t\t\t\treturn undefined;\n\t\t\tsessionStorage.removeItem(key);\n\t\t\treturn JSON.parse(json);\n\t\t}\n\n\t\tsaveApplicationState (state) {\n\t\t\tlet key = 'staple://' + this.namespace + '/imstate';\n\t\t\tsessionStorage.removeItem(key);\n\t\t\tif (!state)\n\t\t\t\treturn;\n\t\t\tlet json = JSON.stringify(state);\n\t\t\tsessionStorage[key] = json;\n\t\t}\n\n\t\tcheckBrowserFeatures (features) {\n\t\t\tlet list = [], checked = {};\n\t\t\tfor (let i = 0, feature; feature = features[i]; ++i) {\n\t\t\t\tlet checker = browserFeatureCheckers[feature];\n\t\t\t\tif (checked[feature])\n\t\t\t\t\tcontinue;\n\t\t\t\tchecked[feature] = true;\n\t\t\t\tif (checker && checker())\n\t\t\t\t\tcontinue;\n\t\t\t\tlist.push(feature);\n\t\t\t}\n\t\t\treturn list;\n\t\t}\n\n\t\tstart (home, interaction, task, extra) {\n\t\t\tlet history = window.history, location = window.location,\n\t\t\t\tattrs = this[$attrs], features = this.meta['browser-features'],\n\t\t\t\ttaskManager = TaskManager.sharedInstance;\n\n\t\t\tlet historyManagement = window.document.head.meta['history-management'] != 'disable';\n\n\t\t\t// Check required browser features.\n\t\t\tfeatures = features ? features.split(',') : [];\n\t\t\tfeatures.concat(requiredBrowserFeatures);\n\t\t\tif (historyManagement)\n\t\t\t\tfeatures.push('historyManagement');\n\t\t\tfeatures = this.checkBrowserFeatures(features);\n\n\t\t\tif (features.length && this.onBrowserFeaturesNotSupport(features))\n\t\t\t\treturn;\n\n\t\t\tattrs.url = location.origin + location.pathname;\n\t\t\tattrs.back = false;\n\n\t\t\tif (historyManagement) {\n\t\t\t\tif (history.state !== '$1') {\n\t\t\t\t\thistory.replaceState('$0', '', attrs.url);\n\t\t\t\t\thistory.pushState('$1', '', attrs.url);\n\t\t\t\t} else {\n\t\t\t\t\thistory.back();\n\t\t\t\t\tattrs.back = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (location.hash !== '#$1')\n\t\t\t\t\tlocation.hash = '$1'\n\t\t\t\telse\n\t\t\t\t\tinteraction = undefined;\n\t\t\t}\n\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onCreate');\n\n\t\t\tlet state = this.loadThenDeleteApplicationState();\n\n\t\t\tif (extra)\n\t\t\t\textra = JSON.parse(extra);\n\n\t\t\tif (interaction) {\n\t\t\t\ttaskManager.startTask('@auto', interaction, extra);\n\t\t\t} else if (state && state.taskManager) {\n\t\t\t\ttaskManager.restoreState(state.taskManager);\n\t\t\t} else if (home) {\n\t\t\t\ttaskManager.startTask(task || '@auto', home, undefined);\n\t\t\t} else {\n\t\t\t\tthrow new Error('Home not specified.');\n\t\t\t}\n\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onResume');\n\n\t\t\tif (historyManagement) {\n\t\t\t\twindow.addEventListener('popstate', this.handlePopState.bind(this));\n\t\t\t} else {\n\t\t\t\twindow.addEventListener('hashchange', this.handleHashChange.bind(this));\n\t\t\t}\n\n\t\t\twindow.addEventListener('unload', this.handleUnload.bind(this));\n\t\t}\n\n\t\thandlePopState () {\n\t\t\tlet history = window.history, attrs = this[$attrs];\n\t\t\tif (history.state == '$1') {\n\t\t\t\thistory.back();\n\t\t\t\tattrs.back = true;\n\t\t\t} else if (attrs.back) {\n\t\t\t\thistory.pushState('$1', '', attrs.url);\n\t\t\t\tattrs.back = false;\n\t\t\t} else {\n\t\t\t\tthis.handleBackPressed();\n\t\t\t\thistory.pushState('$1', '', attrs.url);\n\t\t\t}\n\t\t}\n\n\t\thandleHashChange () {\n\t\t\tlet location = window.location;\n\t\t\tif (location.hash !== '#$1') {\n\t\t\t\tthis.handleBackPressed();\n\t\t\t\tlocation.hash = '$1';\n\t\t\t}\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tlet taskManager = TaskManager.sharedInstance;\n\t\t\ttaskManager.handleBackPressed();\n\t\t}\n\n\t\thandleUnload () {\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onPause');\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onDestroy');\n\t\t}\n\n\t\tgetPreferences (name, shared) {\n\t\t\tlet namespace = shared ? '' : this.namespace,\n\t\t\t\tkey = 'staple://' + namespace + '/prefs/' + name;\n\t\t\tlet preferences = new Preferences(key);\n\t\t\treturn preferences;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Application', {value: Application});\n\tObject.defineProperty(exports, 'default', {value: Application});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/aside.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple aside.\ndefine('staple/aside', function (require, exports, module) {\n\n\tconst PeriodicalTask = require('staple/periodical-task').default;\n\tconst HTMLParser = require('staple/html-parser').default;\n\n\tconst $attrs = Symbol();\n\n\tclass Aside {\n\n\t\tconstructor (interaction, gravity, content) {\n\t\t\tlet attrs = this[$attrs] = {};\n\n\t\t\tattrs.frame = window.document.createElement('div');\n\t\t\tattrs.frame.classList.add('staple-overlay-mask');\n\t\t\tattrs.frame.handleBackPressed = this.handleBackPressed.bind(this);\n\n\t\t\tattrs.gravity = gravity;\n\n\t\t\tif (content)\n\t\t\t\tthis.setContent(content);\n\n\t\t\tattrs.overlayManager = interaction.overlayManager;\n\n\t\t\tlet outsideTouchHandler = this.dismiss.bind(this);\n\n\t\t\tattrs.attachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.addEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.detachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.removeEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.fadeinTask = new PeriodicalTask(100, false);\n\t\t\tattrs.fadeinTask.run = () => {\n\t\t\t\tlet root = this[$attrs].root;\n\t\t\t\tif (!root)\n\t\t\t\t\treturn;\n\t\t\t\troot.classList.add('staple-active');\n\t\t\t};\n\n\t\t\tattrs.attachTask = new PeriodicalTask(800, false);\n\t\t\tattrs.attachTask.run = attrs.attachOutsideTouchHandler.bind(attrs);\n\n\t\t\tattrs.detachTask = new PeriodicalTask(300, false);\n\t\t\tattrs.detachTask.run = attrs.overlayManager.detach.bind(attrs.overlayManager, attrs.frame);\n\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tsetContent (content) {\n\t\t\tif (Object.prototype.toString.call(content) === '[object String]') {\n\t\t\t\tlet elements = HTMLParser.parse(content);\n\t\t\t\tif (elements.length != 1)\n\t\t\t\t\tthrow new Error('Invalid content');\n\t\t\t\tcontent = elements[0];\n\t\t\t}\n\n\t\t\tif (!(content instanceof HTMLElement))\n\t\t\t\tthrow new Error('Content must be an HTML element');\n\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tswitch (attrs.gravity) {\n\t\t\tcase 'bottom':\n\t\t\t\tcontent.classList.add('staple-aside-bottom');\n\t\t\t\tbreak;\n\t\t\tcase 'top':\n\t\t\t\tcontent.classList.add('staple-aside-top');\n\t\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\t\tcontent.classList.add('staple-aside-right');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcontent.classList.add('staple-aside-left');\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcontent.addEventListener('click', evt => evt.stopPropagation());\n\t\t\tcontent.classList.add('staple-aside');\n\t\t\tattrs.frame.innerHTML = '';\n\t\t\tattrs.frame.appendChild(this[$attrs].root = content);\n\t\t}\n\n\t\tselect (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn [ root ];\n\t\t\treturn $A(root.querySelectorAll(selector));\n\t\t}\n\n\t\tselectOne (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn root;\n\t\t\treturn root.querySelector(selector);\n\t\t}\n\n\t\tshow () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tattrs.showing = true;\n\t\t\tattrs.overlayManager.attach(attrs.frame);\n\t\t\tattrs.overlayManager.darken();\n\n\t\t\tattrs.fadeinTask.start(true);\n\t\t\tattrs.attachTask.start(true);\n\t\t\tattrs.detachTask.stop();\n\t\t}\n\n\t\tdismiss () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tattrs.fadeinTask.stop();\n\t\t\tattrs.attachTask.stop();\n\t\t\tattrs.detachTask.start(true);\n\t\t\tattrs.detachOutsideTouchHandler();\n\t\t\tif (attrs.root)\n\t\t\t\tattrs.root.classList.remove('staple-active');\n\t\t\tattrs.overlayManager.lighten();\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tget showing() {\n\t\t\treturn this[$attrs].showing;\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tthis.dismiss();\n\t\t\treturn true;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Aside', {value: Aside});\n\tObject.defineProperty(exports, 'default', {value: Aside});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/dialog.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple dialog.\ndefine('staple/dialog', function (require, exports, module) {\n\n\tconst PeriodicalTask = require('staple/periodical-task').default;\n\tconst HTMLParser = require('staple/html-parser').default;\n\n\tconst $attrs = Symbol();\n\n\tclass Dialog {\n\n\t\tconstructor (interaction, content) {\n\t\t\tlet attrs = this[$attrs] = {};\n\n\t\t\tattrs.frame = window.document.createElement('div');\n\t\t\tattrs.frame.classList.add('staple-overlay-mask');\n\t\t\tattrs.frame.handleBackPressed = this.handleBackPressed.bind(this);\n\n\t\t\tif (content)\n\t\t\t\tthis.setContent(content);\n\n\t\t\tattrs.overlayManager = interaction.overlayManager;\n\n\t\t\tlet outsideTouchHandler = () => {\n\t\t\t\tif (!this.cancelable || !this.cancelOnTouchOutside)\n\t\t\t\t\treturn;\n\t\t\t\tthis.cancel();\n\t\t\t};\n\n\t\t\tattrs.attachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.addEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.detachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.removeEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.fadeinTask = new PeriodicalTask(100, false);\n\t\t\tattrs.fadeinTask.run = () => {\n\t\t\t\tlet root = this[$attrs].root;\n\t\t\t\tif (!root)\n\t\t\t\t\treturn;\n\t\t\t\troot.classList.add('staple-active');\n\t\t\t};\n\n\t\t\tattrs.attachTask = new PeriodicalTask(800, false);\n\t\t\tattrs.attachTask.run = attrs.attachOutsideTouchHandler.bind(attrs);\n\n\t\t\tattrs.detachTask = new PeriodicalTask(300, false);\n\t\t\tattrs.detachTask.run = attrs.overlayManager.detach.bind(attrs.overlayManager, attrs.frame);\n\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tdispatchToListener (eventName) {\n\t\t\tlet listener = this[eventName + 'Listener'] || this;\n\t\t\tif (Object.prototype.toString.call(listener[eventName]) !== '[object Function]')\n\t\t\t\treturn;\n\t\t\tlistener[eventName](this);\n\t\t}\n\n\t\tshow () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tattrs.showing = true;\n\t\t\tattrs.overlayManager.attach(attrs.frame);\n\t\t\tattrs.overlayManager.darken();\n\n\t\t\tattrs.fadeinTask.start(true);\n\t\t\tattrs.attachTask.start(true);\n\t\t\tattrs.detachTask.stop();\n\n\t\t\tthis.dispatchToListener('onShow');\n\t\t}\n\n\t\tdismiss () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tthis.dispatchToListener('onDismiss');\n\n\t\t\tattrs.fadeinTask.stop();\n\t\t\tattrs.attachTask.stop();\n\t\t\tattrs.detachTask.start(true);\n\t\t\tattrs.detachOutsideTouchHandler();\n\t\t\tif (attrs.root)\n\t\t\t\tattrs.root.classList.remove('staple-active');\n\t\t\tattrs.overlayManager.lighten();\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tcancel () {\n\t\t\tif (!this[$attrs].showing)\n\t\t\t\treturn;\n\t\t\tthis.dispatchToListener('onCancel');\n\t\t\tthis.dismiss();\n\t\t}\n\n\t\tsetContent (content) {\n\t\t\tif (Object.prototype.toString.call(content) === '[object String]') {\n\t\t\t\tlet elements = HTMLParser.parse(content);\n\t\t\t\tif (elements.length != 1)\n\t\t\t\t\tthrow new Error('Invalid content');\n\t\t\t\tcontent = elements[0];\n\t\t\t}\n\n\t\t\tif (!(content instanceof HTMLElement))\n\t\t\t\tthrow new Error('Content must be an HTML element');\n\n\t\t\tcontent.addEventListener('click', evt => evt.stopPropagation());\n\t\t\tcontent.open = true;\n\t\t\tcontent.classList.add('staple-dialog');\n\t\t\tlet attrs = this[$attrs];\n\t\t\tattrs.frame.innerHTML = '';\n\t\t\tattrs.frame.appendChild(this[$attrs].root = content);\n\t\t}\n\n\t\tselect (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn [ root ];\n\t\t\treturn $A(root.querySelectorAll(selector));\n\t\t}\n\n\t\tselectOne (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn root;\n\t\t\treturn root.querySelector(selector);\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tthis.onBackPressed();\n\t\t\treturn true;\n\t\t}\n\n\t\tonBackPressed () {\n\t\t\tif (!this.cancelable)\n\t\t\t\treturn;\n\t\t\tthis.cancel();\n\t\t}\n\n\t\tget showing () {\n\t\t\treturn this[$attrs].showing;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Dialog', {value: Dialog});\n\tObject.defineProperty(exports, 'default', {value: Dialog});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/html-parser.js\n * @author\tEric.Tsai\n *\n */\n\n// HTML parser.\ndefine('staple/html-parser', function (require, exports, module) {\n\n\tconst factroy = window.document.createElement('div');\n\n\tclass HTMLParser {\n\n\t\tconstructor () {\n\t\t\tthrow new Error('This class can not be initialized');\n\t\t}\n\n\t}\n\n\tHTMLParser.parse = function (html) {\n\t\tfactroy.innerHTML = html;\n\t\tlet children = factroy.children, result = [];\n\t\tfor (let i = 0, child; child = children[i]; ++i)\n\t\t\tresult.push(child);\n\t\tfactroy.innerHTML = '';\n\t\treturn result;\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'HTMLParser', {value: HTMLParser});\n\tObject.defineProperty(exports, 'default', {value: HTMLParser});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/interaction.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple interaction.\ndefine('staple/interaction', function (require, exports, module) {\n\n\tconst Application = require('staple/application').default;\n\tconst HTMLParser = require('staple/html-parser').default;\n\tconst PeriodicalTask = require('staple/periodical-task').default;\n\n\tconst [$attrs, $temps] = [Symbol(), Symbol()];\n\n\tclass OverlayManager {\n\n\t\tconstructor () {\n\t\t\tthis.panel = window.document.createElement('div');\n\t\t\tthis.panel.id = 'staple-overlay';\n\t\t\tthis.panel.classList.add('staple-overlay');\n\t\t\tthis.updater = new PeriodicalTask(100, false, this);\n\t\t\tthis.darkness = 0;\n\t\t}\n\n\t\tresume () {\n\t\t\twindow.document.body.appendChild(this.panel);\n\t\t\tthis.updater.start(true);\n\t\t}\n\n\t\tpause () {\n\t\t\tthis.updater.stop();\n\t\t\twindow.document.body.removeChild(this.panel);\n\t\t}\n\n\t\tdarken () {\n\t\t\t++this.darkness;\n\t\t\tthis.updater.start(true);\n\t\t}\n\n\t\tlighten () {\n\t\t\t--this.darkness;\n\t\t\tthis.updater.start(true);\n\t\t}\n\n\t\trun () {\n\t\t\tlet panel = this.panel;\n\n\t\t\tif (panel.childElementCount === 0)\n\t\t\t\tpanel.classList.remove('staple-active');\n\t\t\telse\n\t\t\t\tpanel.classList.add('staple-active');\n\n\t\t\tif (this.darkness === 0)\n\t\t\t\tpanel.classList.remove('staple-overlay-dim');\n\t\t\telse\n\t\t\t\tpanel.classList.add('staple-overlay-dim');\n\t\t}\n\n\t\tattach (overlay) {\n\t\t\tthis.panel.appendChild(overlay);\n\t\t\tthis.updater.start(true);\n\t\t}\n\n\t\tdetach (overlay) {\n\t\t\tthis.panel.removeChild(overlay);\n\t\t\tthis.run();\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tlet target = this.panel.lastElementChild;\n\t\t\twhile (target) {\n\t\t\t\tif (target.handleBackPressed())\n\t\t\t\t\treturn true;\n\t\t\t\ttarget = target.previousElementSibling;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\tclass Interaction {\n\n\t\tconstructor (task, $peeker, context) {\n\t\t\tthis[$attrs] = this[$peeker] = {task: task, context: context};\n\t\t\tthis[$temps] = {};\n\t\t}\n\n\t\tinvokeMethodAndEnsureSuperCalled (method) {\n\t\t\tthis[$temps][method] = false;\n\t\t\tlet result = this[method].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\tif (this[$temps][method] != method)\n\t\t\t\tthrow new Error('super.' + method + '() not called in ' + this.constructor.name + '.' + method + '()');\n\t\t\tdelete this[$temps][method];\n\t\t\treturn result;\n\t\t}\n\n\t\tnotifySuperCalled (method) {\n\t\t\tthis[$temps][method] = method;\n\t\t}\n\n\t\tcreate (state) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tattrs.active = false;\n\t\t\tattrs.tasks = {};\n\t\t\tattrs.overlayManager = new OverlayManager();\n\n\t\t\tattrs.creating = true;\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onCreate', state);\n\t\t\tdelete attrs.creating;\n\n\t\t\t// Delegate click event.\n\t\t\tthis[$attrs].root.onclick = event => {\n\t\t\t\tlet target = event.target;\n\t\t\t\twhile (target) {\n\t\t\t\t\tlet handler = this[target.getAttribute('staple:click')];\n\t\t\t\t\tif (Object.prototype.toString.call(handler) === '[object Function]') {\n\t\t\t\t\t\thandler.call(this, target);\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentElement;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tonCreate (state) {\n\t\t\tthis.notifySuperCalled('onCreate');\n\t\t}\n\n\t\tperformRestoreInstanceState (state) {\n\t\t\tthis.onRestoreInstanceState(state);\n\t\t}\n\n\t\tonRestoreInstanceState (state) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tresume () {\n\t\t\tthis[$attrs].active = true;\n\t\t\tApplication.sharedInstance.onTitleChanged(this.getTitle());\n\t\t\tthis[$attrs].overlayManager.resume();\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onResume');\n\t\t}\n\n\t\tonResume () {\n\t\t\tthis.notifySuperCalled('onResume');\n\t\t}\n\n\t\tonInteractionResult (request, result, data) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tpause () {\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onPause');\n\t\t\tthis[$attrs].overlayManager.pause();\n\t\t\tthis[$attrs].active = false;\n\t\t}\n\n\t\tonPause () {\n\t\t\tthis.notifySuperCalled('onPause');\n\t\t}\n\n\t\tperformSaveInstanceState (state) {\n\t\t\tthis.onSaveInstanceState(state);\n\t\t}\n\n\t\tonSaveInstanceState (state) {\n\t\t\t// Default do nothing.\n\t\t}\n\n\t\tdestroy () {\n\t\t\tthis.invokeMethodAndEnsureSuperCalled('onDestroy');\n\t\t\tlet tasks = this[$attrs].tasks;\n\t\t\tfor (let key in tasks) {\n\t\t\t\tlet task = tasks[key];\n\t\t\t\ttask.stop();\n\t\t\t\tdelete tasks[key];\n\t\t\t}\n\t\t}\n\n\t\tonDestroy () {\n\t\t\tthis.notifySuperCalled('onDestroy');\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tif (this[$attrs].overlayManager.handleBackPressed())\n\t\t\t\treturn;\n\t\t\tthis.onBackPressed();\n\t\t}\n\n\t\tonBackPressed () {\n\t\t\tthis.finish();\n\t\t}\n\n\t\tfinish () {\n\t\t\tlet task = this[$attrs].task;\n\t\t\ttask.finishInteraction(this[$attrs].context.uuid);\n\t\t}\n\n\t\tstartInteraction (name, extra, request) {\n\t\t\tlet task = this[$attrs].task, context = this[$attrs].context,\n\t\t\t\tparent = request ? context.uuid : undefined;\n\t\t\tif (!request)\n\t\t\t\trequest = undefined;\n\t\t\ttask.startInteraction(parent, request, name, extra);\n\t\t}\n\n\t\tgetExtra () {\n\t\t\treturn this.extra;\n\t\t}\n\n\t\tget extra () {\n\t\t\treturn this[$attrs].context.extra;\n\t\t}\n\n\t\tgetUUID () {\n\t\t\treturn this.uuid;\n\t\t}\n\n\t\tget uuid () {\n\t\t\treturn this[$attrs].context.uuid;\n\t\t}\n\n\t\tget overlayManager () {\n\t\t\treturn this[$attrs].overlayManager;\n\t\t}\n\n\t\tgetApplication () {\n\t\t\treturn this.application;\n\t\t}\n\n\t\tget application () {\n\t\t\treturn Application.sharedInstance;\n\t\t}\n\n\t\tsetResult (result, data) {\n\t\t\tlet context = this[$attrs].context;\n\t\t\tcontext.resultCode = result;\n\t\t\tcontext.resultData = data;\n\t\t}\n\n\t\tgetPreferences (name, shared) {\n\t\t\treturn Application.sharedInstance.getPreferences(name, shared);\n\t\t}\n\n\t\tsetContent (content) {\n\t\t\tif (!this[$attrs].creating)\n\t\t\t\tthrow new Error('setContent() must be called during onCreate()');\n\n\t\t\tif (Object.prototype.toString.call(content) === '[object String]') {\n\t\t\t\tlet elements = HTMLParser.parse(content);\n\t\t\t\tif (elements.length != 1)\n\t\t\t\t\tthrow new Error('Invalid content');\n\t\t\t\tcontent = elements[0];\n\t\t\t}\n\n\t\t\tif (!(content instanceof HTMLElement))\n\t\t\t\tthrow new Error('Content must be an HTML element');\n\n\t\t\tcontent.classList.add('staple-interaction');\n\t\t\tthis[$attrs].root = content;\n\t\t}\n\n\t\tgetTitle () {\n\t\t\tlet root = this[$attrs].root, title = root ? root.dataset.title : undefined;\n\t\t\treturn title ? title : Application.sharedInstance.title;\n\t\t}\n\n\t\tsetTitle (title) {\n\t\t\tthis[$attrs].root.dataset.title = title;\n\t\t\tif (!this[$attrs].active)\n\t\t\t\treturn title;\n\t\t\tlet reslovedTitle = title ? title : Application.sharedInstance.title;\n\t\t\tApplication.sharedInstance.onTitleChanged(reslovedTitle);\n\t\t\treturn title;\n\t\t}\n\n\t\tget title () {\n\t\t\treturn getTitle();\n\t\t}\n\n\t\tset title (title) {\n\t\t\treturn setTitle(title);\n\t\t}\n\n\t\tselect(selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn [ root ];\n\t\t\treturn $A(root.querySelectorAll(selector));\n\t\t}\n\n\t\tselectOne(selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn root;\n\t\t\treturn root.querySelector(selector);\n\t\t}\n\n\t\tscheduleRunnable (runnable, ms, repeat) {\n\t\t\tlet task = new PeriodicalTask(ms, repeat, runnable)\n\t\t\ttask.runnable = runnable;\n\t\t\tthis[$attrs].tasks[task.id] = task;\n\t\t\ttask.start();\n\t\t\treturn task.id;\n\t\t}\n\n\t\tcancelRunnables (runnable) {\n\t\t\tlet tasks = this[$attrs].tasks;\n\n\t\t\tif (Number.isInteger(runnable)) {\n\t\t\t\tlet task = tasks[runnable];\n\t\t\t\tif (task) {\n\t\t\t\t\ttask.stop();\n\t\t\t\t\tdelete tasks[runnable];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (let key in tasks) {\n\t\t\t\t\tlet task = tasks[key];\n\t\t\t\t\tif (task.runnable !== runnable)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\ttask.stop();\n\t\t\t\t\tdelete tasks[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Interaction', {value: Interaction});\n\tObject.defineProperty(exports, 'default', {value: Interaction});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/nls.js\n * @author\tEric.Tsai\n *\n */\n\n// A module usd to load specified NLS(Native Language Support) bundle.\ndefine('staple/nls', function (require, exports, module) {\n\n\tclass NLSBundleLoader {\n\n\t\tconstructor (bundle, languages, require, onload) {\n\t\t\tthis.bundle = bundle;\n\t\t\tthis.languages = languages;\n\t\t\tthis.require = require;\n\t\t\tthis.onload = onload;\n\t\t}\n\n\t\tload () {\n\t\t\t// Load master of NLS bundle.\n\t\t\trequire([this.bundle + '/master'], this.onMasterLoaded.bind(this));\n\t\t}\n\n\t\tonMasterLoaded (master) {\n\t\t\tlet parts = this.parts = [], needed = this.needed = [],\n\t\t\t\tnames = [];\n\t\t\tlet languages = this.languages;\n\n\t\t\tthis.master = master = master.default;\n\n\t\t\t// Checkout which stand-alone NLS parts need to load.\n\t\t\tfor (let i = languages.length - 1; i >= 0; --i) {\n\t\t\t\tlet language = languages[i];\n\t\t\t\tif (!language)\n\t\t\t\t\tcontinue;\n\t\t\t\tlanguage = language.toLowerCase();\n\t\t\t\tlet value = master[language];\n\t\t\t\tif (!value)\n\t\t\t\t\tcontinue;\n\t\t\t\tparts.push(language);\n\t\t\t\tif (typeof value === 'object')\n\t\t\t\t\tcontinue;\n\t\t\t\tneeded.push(language);\n\t\t\t\tnames.push(this.bundle + '/' + language);\n\t\t\t}\n\n\t\t\t// Load needed stand-alone NLS parts\n\t\t\tthis.require(names, this.onPartsLoaded.bind(this));\n\t\t}\n\n\t\tonPartsLoaded () {\n\t\t\tlet master = this.master, needed = this.needed, parts = this.parts,\n\t\t\t\tvalues = {};\n\n\t\t\t// Add add stand-along NLS part to master.\n\t\t\tfor (let i = 0; i < needed.length; ++i)\n\t\t\t\tmaster[needed[i]] = arguments[i].default;\n\n\t\t\t// Mixin all locale parts into a bundle.\n\t\t\tlet bundle = {'@name' : this.bundle};\n\t\t\tfor (let i = 0, source; source = master[parts[i]]; ++i)\n\t\t\t\tfor (let prop in source)\n\t\t\t\t\tbundle[prop] = source[prop];\n\n\t\t\t// Create exports\n\t\t\tlet exports = {};\n\t\t\tfor (let prop in bundle)\n\t\t\t\tObject.defineProperty(exports, prop, {value: bundle[prop]});\n\n\t\t\t// Notify bundle loaded.\n\t\t\tObject.defineProperty(exports, '__esModule', {value: true});\n\t\t\tObject.defineProperty(exports, 'default', {value: exports});\n\t\t\tthis.onload(exports);\n\t\t}\n\n\t}\n\n\tfunction load (name, require, onload, config) {\n\t\tif (config.isBuild)\n\t\t\treturn onload(null)\n\n\t\tlet languages = [];\n\n\t\t// Customized languages\n\t\tif (navigator.customizedLanguage)\n\t\t\tlanguages.push(navigator.customizedLanguage);\n\n\t\t// Browser languages\n\t\tif (navigator.language)\n\t\t\tlanguages.push(navigator.language);\n\t\tif (navigator.languages)\n\t\t\tlanguages = languages.concat(navigator.languages);\n\n\t\t// Default language\n\t\tlanguages.push('root');\n\n\t\t// Deduplicate\n\t\tlet unique = [], map = {};\n\t\tfor (let i = 0, lang; lang = languages[i]; ++i) {\n\t\t\tif (map[lang])\n\t\t\t\tcontinue;\n\t\t\tmap[lang] = true;\n\t\t\tunique.push(lang);\n\t\t}\n\t\tlanguages = unique;\n\n\t\t// Load bundle.\n\t\tlet loader = new NLSBundleLoader(name, languages, require, onload);\n\t\tloader.load();\n\t}\n\n\texports.load = load;\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/periodical-task.js\n * @author\tEric.Tsai\n *\n */\n\n// Periodical task.\ndefine('staple/periodical-task', function (require, exports, module) {\n\nconst $attrs = Symbol();\n\nlet sequence = 0;\n\nclass PeriodicalTask {\n\n\tconstructor (ms, repeat, runnable) {\n\t\tthis[$attrs] = {\n\t\t\trunnable: runnable,\n\t\t\tms: ms,\n\t\t\trepeat: repeat,\n\t\t\tid: ++sequence,\n\t\t};\n\t}\n\n\thandler () {\n\t\tlet attrs = this[$attrs];\n\t\tif (!attrs.repeat)\n\t\t\tdelete attrs.tid;\n\t\tlet runnable = attrs.runnable || this;\n\t\trunnable.run();\n\t}\n\n\tstart (restart) {\n\t\tlet attrs = this[$attrs];\n\t\tif (attrs.tid) {\n\t\t\tif (!restart)\n\t\t\t\treturn;\n\t\t\tlet stopFunc = attrs.repeat ? clearInterval : clearTimeout;\n\t\t\tstopFunc(attrs.tid);\n\t\t}\n\t\tlet startFunc = attrs.repeat ? setInterval : setTimeout;\n\t\tattrs.tid = startFunc(this.handler.bind(this), attrs.ms);\n\t}\n\n\tstop () {\n\t\tlet attrs = this[$attrs];\n\t\tif (!attrs.tid)\n\t\t\treturn;\n\t\tlet stopFunc = attrs.repeat ? clearInterval : clearTimeout;\n\t\tstopFunc(attrs.tid);\n\t\tdelete attrs.tid;\n\t}\n\n\tget running () {\n\t\treturn this[$attrs].tid ? true : false;\n\t}\n\n\tget id () {\n\t\treturn this[$attrs].id;\n\t}\n\n}\n\nObject.defineProperty(exports, '__esModule', {value: true});\nObject.defineProperty(exports, 'PeriodicalTask', {value: PeriodicalTask});\nObject.defineProperty(exports, 'default', {value: PeriodicalTask});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/popup.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple popup.\ndefine('staple/popup', function (require, exports, module) {\n\n\tconst PeriodicalTask = require('staple/periodical-task').default;\n\tconst HTMLParser = require('staple/html-parser').default;\n\n\tconst $attrs = Symbol();\n\n\tclass Popup {\n\n\t\tconstructor (interaction, gravity, content) {\n\t\t\tlet attrs = this[$attrs] = {};\n\n\t\t\tattrs.frame = window.document.createElement('div');\n\t\t\tattrs.frame.classList.add('staple-overlay-mask');\n\t\t\tattrs.frame.handleBackPressed = this.handleBackPressed.bind(this);\n\n\t\t\tattrs.gravity = gravity;\n\n\t\t\tif (content)\n\t\t\t\tthis.setContent(content);\n\n\t\t\tattrs.overlayManager = interaction.overlayManager;\n\n\t\t\tlet outsideTouchHandler = this.dismiss.bind(this);\n\n\t\t\tattrs.attachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.addEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.detachOutsideTouchHandler = function () {\n\t\t\t\tthis.frame.removeEventListener('click', outsideTouchHandler);\n\t\t\t};\n\n\t\t\tattrs.fadeinTask = new PeriodicalTask(100, false);\n\t\t\tattrs.fadeinTask.run = () => {\n\t\t\t\tlet root = this[$attrs].root;\n\t\t\t\tif (!root)\n\t\t\t\t\treturn;\n\t\t\t\troot.classList.add('staple-active');\n\t\t\t};\n\n\t\t\tattrs.attachTask = new PeriodicalTask(800, false);\n\t\t\tattrs.attachTask.run = attrs.attachOutsideTouchHandler.bind(attrs);\n\n\t\t\tattrs.detachTask = new PeriodicalTask(300, false);\n\t\t\tattrs.detachTask.run = attrs.overlayManager.detach.bind(attrs.overlayManager, attrs.frame);\n\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tsetContent (content) {\n\t\t\tif (Object.prototype.toString.call(content) === '[object String]') {\n\t\t\t\tlet elements = HTMLParser.parse(content);\n\t\t\t\tif (elements.length != 1)\n\t\t\t\t\tthrow new Error('Invalid content');\n\t\t\t\tcontent = elements[0];\n\t\t\t}\n\n\t\t\tif (!(content instanceof HTMLElement))\n\t\t\t\tthrow new Error('Content must be an HTML element');\n\n\t\t\tlet attrs = this[$attrs];\n\t\t\tcontent.addEventListener('click', evt => evt.stopPropagation());\n\t\t\tcontent.classList.add('staple-popup');\n\t\t\tattrs.frame.innerHTML = '';\n\t\t\tattrs.frame.appendChild(this[$attrs].root = content);\n\n\t\t\tif (!attrs.showing)\n\t\t\t\treturn;\n\t\t\tthis.adjustPopupPosition();\n\t\t}\n\n\t\tselect (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn [ root ];\n\t\t\treturn $A(root.querySelectorAll(selector));\n\t\t}\n\n\t\tselectOne (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn root;\n\t\t\treturn root.querySelector(selector);\n\t\t}\n\n\t\tshowAtLocation (x, y) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tattrs.x = x;\n\t\t\tattrs.y = y;\n\n\t\t\tif (!attrs.showing) {\n\t\t\t\tattrs.showing = true;\n\t\t\t\tattrs.overlayManager.attach(attrs.frame);\n\t\t\t\tattrs.fadeinTask.start(true);\n\t\t\t\tattrs.attachTask.start(true);\n\t\t\t\tattrs.detachTask.stop();\n\t\t\t}\n\n\t\t\tthis.adjustPopupPosition();\n\t\t}\n\n\t\tadjustPopupPosition () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing || !attrs.root)\n\t\t\t\treturn;\n\n\t\t\tlet ox = attrs.x, oy = attrs.y, x = ox, y = oy;\n\n\t\t\tlet pgstrs = (attrs.gravity || '').replace(/\\s+/g, '').split('|');\n\t\t\tfor (let i = 0, pg; pg = pgstrs[i]; ++i) {\n\t\t\t\tswitch (pg) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tx = ox;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'top':\n\t\t\t\t\ty = oy;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\tx = ox - attrs.root.offsetWidth;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bottom':\n\t\t\t\t\ty = oy - attrs.root.offsetHeight;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tattrs.root.style.left = x + 'px';\n\t\t\tattrs.root.style.top = y + 'px';\n\t\t}\n\n\t\tshowAsDropDown (anchor, tx, ty, gravity) {\n\t\t\tlet arect = anchor.getBoundingClientRect();\n\n\t\t\tlet x = arect.left, y = arect.top;\n\t\t\tlet agstrs = (gravity || '').replace(/\\s+/g, '').split('|');\n\t\t\tfor (let i = 0, ag; ag = agstrs[i]; ++i) {\n\t\t\t\tswitch (ag) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tx = arect.left;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'top':\n\t\t\t\t\ty = arect.top;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\tx = arect.right;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bottom':\n\t\t\t\t\ty = arect.bottom;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.showAtLocation(x + (tx || 0), y + (ty || 0));\n\t\t}\n\n\t\tset gravity (gravity) {\n\t\t\tthis[$attrs].gravity = gravity;\n\t\t\treturn gravity;\n\t\t}\n\n\t\tget gravity () {\n\t\t\treturn this[$attrs].gravity;\n\t\t}\n\n\t\tdismiss () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tattrs.fadeinTask.stop();\n\t\t\tattrs.attachTask.stop();\n\t\t\tattrs.detachTask.start(true);\n\t\t\tattrs.detachOutsideTouchHandler();\n\t\t\tif (attrs.root)\n\t\t\t\tattrs.root.classList.remove('staple-active');\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tget showing () {\n\t\t\treturn this[$attrs].showing;\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tthis.dismiss();\n\t\t\treturn true;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Popup', {value: Popup});\n\tObject.defineProperty(exports, 'default', {value: Popup});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/snippets.js\n * @author\tEric.Tsai\n *\n */\n\n// A module usd to load HTML snippets from an snippets file.\ndefine('staple/snippets', function (require, exports, module) {\n\n\tconst HTMLParser = require('staple/html-parser').default;\n\tconst [loadersMap, snippetsMap] = [{}, {}];\n\n\tclass SnippetsLoader {\n\n\t\tconstructor (path, require, onload) {\n\t\t\tthis.path = path;\n\t\t\tthis.require = require;\n\t\t\tthis.onload = onload;\n\t\t}\n\n\t\tnotifyError (text) {\n\t\t\tlet error = new Error('Failed to load snippet file: ' + this.path + '(' + text + ').');\n\t\t\tthis.onload.error(error);\n\t\t}\n\n\t\tload () {\n\t\t\tlet xhr = new XMLHttpRequest();\n\t\t\txhr.open('get', this.require.toUrl(this.path + '.html'), true);\n\t\t\txhr.onreadystatechange = evt => {\n\t\t\t\tif (xhr.readyState != 4)\n\t\t\t\t\treturn;\n\t\t\t\tif (xhr.status != 200 && xhr.status != 0) // WKWebView returns 0 for file urls\n\t\t\t\t\treturn this.onHTMLNotLoaded(xhr);\n\t\t\t\tthis.onHTMLLoaded(xhr);\n\t\t\t};\n\t\t\txhr.send();\n\t\t}\n\n\t\tonHTMLLoaded (xhr) {\n\t\t\tlet html = this.html = xhr.responseText;\n\n\t\t\t// Find all NLS placeholders.\n\t\t\tlet matches = html.match(/\\[nls\\@[a-zA-Z0-9\\-\\/_]+:[a-zA-Z0-9\\-_]+\\]/g);\n\n\t\t\t// No NLS placeholders, mark ready and return.\n\t\t\tif (!matches || !matches.length)\n\t\t\t\treturn this.onNLSResolved();\n\n\t\t\t// Prepare to load NLS bundles.\n\t\t\tlet nlsphs = this.nlsphs = [], names = [], namemap = {};\n\t\t\tfor (let i = 0, match; match = matches[i]; ++i) {\n\t\t\t\tlet pair = match.substr(5, match.length - 6).split(':');\n\t\t\t\tnlsphs.push({\n\t\t\t\t\tmatch : match,\n\t\t\t\t\tname : pair[0],\n\t\t\t\t\tkey : pair[1],\n\t\t\t\t});\n\t\t\t\tif (namemap[pair[0]])\n\t\t\t\t\tcontinue;\n\t\t\t\tnamemap[pair[0]] = true;\n\t\t\t\tnames.push('staple/nls!' + pair[0]);\n\t\t\t}\n\n\t\t\t// Load NLS Bundles\n\t\t\tthis.require(names, this.onNLSLoaded.bind(this));\n\t\t}\n\n\t\tonHTMLNotLoaded (xhr) {\n\t\t\tthis.notifyError(xhr.status);\n\t\t}\n\n\t\tonNLSLoaded () {\n\t\t\tlet nlsphs = this.nlsphs, html = this.html;\n\n\t\t\t// Build a lookup map for loaded NLS bundles.\n\t\t\tlet bundles = {};\n\t\t\tfor (let i = 0, bundle; bundle = arguments[i]; ++i)\n\t\t\t\tbundles[bundle.default['@name']] = bundle.default;\n\n\t\t\t// Replace all NLS placeholders with NLS strings.\n\t\t\tfor (let i = 0, nlsph; nlsph = nlsphs[i]; ++i)\n\t\t\t\thtml = html.replace(nlsph.match, bundles[nlsph.name][nlsph.key]);\n\n\t\t\tthis.html = html;\n\t\t\tthis.onNLSResolved();\n\t\t}\n\n\t\tonNLSResolved () {\n\t\t\tlet html = this.html, head = window.document.head, snippets = {};\n\n\t\t\tfor (let i = 0, els = HTMLParser.parse(html), el; el = els[i]; ++i) {\n\t\t\t\tswitch (el.tagName.toLowerCase()) {\n\t\t\t\tcase 'style':\n\t\t\t\t\thead.appendChild(el);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'script':\n\t\t\t\t\tif (el.type !== 'text/html' || !el.id)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tObject.defineProperty(snippets, el.id, {value: el.innerHTML.trim()});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tObject.defineProperty(snippets, '__esModule', {value: true});\n\t\t\tObject.defineProperty(snippets, 'default', {value: snippets});\n\t\t\tthis.onload(snippets);\n\t\t}\n\n\t}\n\n\tfunction load (name, require, onload, config) {\n\t\tif (config.isBuild)\n\t\t\treturn onload(null);\n\n\t\tlet loader = new SnippetsLoader(name, require, onload);\n\t\tloader.load();\n\t};\n\n\texports.load = load;\n\n});\n"," /*\n * Copyright (C) 2021 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/task-manager.js\n * @author\tEric.Tsai\n *\n */\n\ndefine('staple/task-manager', function (require, exports, module) {\n\n\tconst $attrs = Symbol();\n\n  const HTMLParser = require('staple/html-parser').default;\n\tconst Task = require('staple/task').default;\n\tconst UUID = require('staple/uuid').default;\n\n  const snippets = '' +\n\t\t'<div id=\"staple-interrupter\" class=\"staple-interrupter\"></div>' +\n\t\t'<div id=\"staple-workspace\" class=\"staple-workspace\"></div>' +\n\t\t'';\n\n\tclass TaskManager {\n\n\t\tconstructor () {\n\t\t\tif (TaskManager.sharedInstance)\n\t\t\t\tthrow new Error('Instance of TaskManager already exist.');\n\t\t\tthis[$attrs] = {};\n\t\t}\n\n\t\tcreate () {\n\t\t\tlet body = window.document.body;\n\n\t\t\t// Initialize loading indicator.\n\t\t\tlet attrs = this[$attrs];\n\t\t\tlet indicator = attrs.indicator = body.querySelector('#staple-indicator');\n\t\t\tattrs.loading = false;\n\n\t\t\tlet elements = HTMLParser.parse(snippets);\n\n\t\t\t// Initialize a interrupter used to interrupt user inputs when framework is busy.\n\t\t\tlet interrupter = attrs.interrupter = elements[0];\n\t\t\tattrs.busy = false;\n\t\t\tinterrupter.style.backgroundColor = 'transparent';\n\t\t\tbody.appendChild(interrupter);\n\n\t\t\t// Initialize workspace.\n\t\t\tlet workspace = attrs.workspace = elements[1];\n\t\t\tbody.appendChild(workspace);\n\n\t\t\tlet tasks = attrs.tasks = [];\n\t\t\ttasks.remove = function(target) {\n\t\t\t\tlet temp = this.concat();\n\t\t\t\tthis.length = 0;\n\t\t\t\tfor (let i = 0, task; task = temp[i]; ++i) {\n\t\t\t\t\tif (target === task)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tthis.push(task);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t};\n\t\t\ttasks.top = function() {\n\t\t\t\treturn this[this.length - 1];\n\t\t\t};\n\t\t\ttasks.findByName = function(name) {\n\t\t\t\tfor (let i = 0, task; task = this[i]; ++i)\n\t\t\t\t\tif (task.name == name)\n\t\t\t\t\t\treturn task;\n\t\t\t\treturn undefined;\n\t\t\t};\n\n\t\t\tattrs.maxTaskCount = 8;\n\t\t\tattrs.paused = true;\n\t\t}\n\n\t\tresume() {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (!attrs.paused)\n\t\t\t\treturn;\n\n\t\t\tlet task = attrs.tasks.top();\n\t\t\tif (task)\n\t\t\t\ttask.resume(), staple.application.onTaskActivated(task.name, undefined);\n\t\t\tattrs.paused = false;\n\t\t}\n\n\t\tpause() {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (attrs.paused)\n\t\t\t\treturn;\n\n\t\t\tlet task = attrs.tasks.top();\n\t\t\tif (task)\n\t\t\t\ttask.pause();\n\t\t\tattrs.paused = true;\n\t\t}\n\n\t\tdestroy() {\n\t\t\tlet tasks = this[$attrs].tasks;\n\t\t\tfor (let task of tasks)\n\t\t\t\ttask.destroy();\n\t\t\ttasks.length = 0;\n\t\t}\n\n\t\tsaveState() {\n\t\t\tlet attrs = this[$attrs], tasks = [];\n\n\t\t\tfor (let task of attrs.tasks)\n\t\t\t\ttasks.push(task.saveState());\n\n\t\t\tif (tasks.length == 0)\n\t\t\t\treturn undefined;\n\n\t\t\treturn {tasks: tasks};\n\t\t}\n\n\t\trestoreState(state) {\n\t\t\tlet attrs = this[$attrs], tasks = attrs.tasks;\n\t\t\tlet taskStates = state.tasks;\n\n\t\t\ttasks.length = 0;\n\t\t\tfor (let taskState of taskStates) {\n\t\t\t\tlet task = new Task(this, undefined, $attrs);\n\t\t\t\ttask.create();\n\t\t\t\ttask.restoreState(taskState);\n\t\t\t\ttasks.push(task);\n\t\t\t\tstaple.application.onTaskStarted(task.name);\n\t\t\t}\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (attrs.paused)\n\t\t\t\treturn;\n\n\t\t\tlet task = attrs.tasks.top();\n\t\t\tif (!task)\n\t\t\t\treturn;\n\t\t\ttask.handleBackPressed();\n\t\t}\n\n\t\tstartTask(name, interaction, extra) {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tname = (name && name != '@auto') ? name : UUID.randomUUID();\n\t\t\tlet exist = attrs.tasks.findByName(name);\n\t\t\tif (exist)\n\t\t\t\treturn name;\n\n\t\t\tlet top = attrs.tasks.top();\n\t\t\tif (top && !attrs.paused)\n\t\t\t\ttop.pause();\n\n\t\t\tlet task = new Task(this, name, $attrs);\n\t\t\tattrs.tasks.push(task);\n\t\t\ttask.create();\n\t\t\tif (!attrs.paused)\n\t\t\t\ttask.resume();\n\t\t\ttask.startInteraction(undefined, undefined, interaction, extra);\n\t\t\tstaple.application.onTaskStarted(name);\n\t\t\tstaple.application.onTaskActivated(name, top ? top.name : undefined);\n\t\t\treturn name;\n\t\t}\n\n\t\tswitchTask(name) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tlet task = attrs.tasks.findByName(name);\n\t\t\tif (!task)\n\t\t\t\treturn;\n\n\t\t\tlet top = attrs.tasks.top();\n\t\t\tif (task == top)\n\t\t\t\treturn;\n\n\t\t\tattrs.tasks.remove(task);\n\t\t\tif (!attrs.paused) {\n\t\t\t\ttop.pause();\n\t\t\t\ttask.resume();\n\t\t\t}\n\n\t\t\tattrs.tasks.push(task);\n\n\t\t\tstaple.application.onTaskActivated(task.name, top.name);\n\t\t}\n\n\t\tfinishTask(name) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tlet task = attrs.tasks.findByName(name);\n\t\t\tif (!task)\n\t\t\t\treturn;\n\n\t\t\tlet isTop = (task == attrs.tasks.top());\n\n\t\t\tif (isTop && !attrs.paused)\n\t\t\t\ttask.pause();\n\n\t\t\ttask.destroy();\n\t\t\tattrs.tasks.remove(task);\n\t\t\tstaple.application.onTaskFinished(name);\n\n\t\t\tlet top = attrs.tasks.top();\n\t\t\tif (!top) {\n\t\t\t\tstaple.application.onLastTaskFinished();\n\t\t\t} else if (isTop && !attrs.paused) {\n\t\t\t\ttop.resume();\n\t\t\t\tstaple.application.onTaskActivated(top.name, undefined);\n\t\t\t} else {\n\t\t\t\t// Do nothing.\n\t\t\t}\n\t\t}\n\n\t\tcanGoBack (name) {\n\t\t\tlet task = this[$attrs].tasks.findByName(name);\n\t\t\tif (!task)\n\t\t\t\treturn false;\n\t\t\treturn task.interactions > 1\n\t\t}\n\n\t\thasTask (name) {\n\t\t\tlet task = this[$attrs].tasks.findByName(name);\n\t\t\treturn !!task;\n\t\t}\n\n\t\tsetBusy (busy) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (attrs.busy == busy)\n\t\t\t\treturn;\n\t\t\tattrs.interrupter.style.zIndex = busy ? 2000000000 : 0;\n\t\t\tattrs.busy = busy;\n\t\t}\n\n\t\tsetLoading (loading) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (attrs.loading == loading)\n\t\t\t\treturn;\n\t\t\tlet classes = attrs.indicator.classList;\n\t\t\tif (loading)\n\t\t\t\tclasses.add('staple-active');\n\t\t\telse\n\t\t\t\tclasses.remove('staple-active');\n\t\t\tattrs.loading = loading;\n\t\t}\n\n\t\tget tasks () {\n\t\t\tlet tasks = this[$attrs].tasks;\n\t\t\tlet names = [];\n\t\t\tfor (let task of tasks)\n\t\t\t\tnames.push(task.name);\n\t\t\treturn names;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(TaskManager, \"sharedInstance\", {value: new TaskManager()});\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'TaskManager', {value: TaskManager});\n\tObject.defineProperty(exports, 'default', {value: TaskManager});\n\n});\n","/*\n * Copyright (C) 2021 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/task.js\n * @author\tEric.Tsai\n *\n */\n\ndefine('staple/task', function (require, exports, module) {\n\n\tconst HTMLParser = require('staple/html-parser').default;\n\tconst UUID = require('staple/uuid').default;\n\n\tconst snippets = '<div id=\"staple-desktop\" class=\"staple-desktop\"></div>';\n\n\tconst $attrs = Symbol();\n\n\tclass Task {\n\n\t\tconstructor (manager, name, $peeker) {\n\t\t\tthis[$attrs] = this[$peeker] = {name: name, manager: manager, $peeker: $peeker};\n\t\t}\n\n\t\tget name() {\n\t\t\treturn this[$attrs].name;\n\t\t}\n\n\t\tget interactions() {\n\t\t\treturn this[$attrs].contexts.length;\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\tlet active = this[$attrs].active;\n\t\t\tif (!active)\n\t\t\t\treturn;\n\t\t\tactive.handleBackPressed();\n\t\t}\n\n\t\tcreate () {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tattrs.loading = false;\n\t\t\tattrs.busy = false;\n\n\t\t\t// Initialize desktop.\n\t\t\tlet desktop = attrs.desktop = HTMLParser.parse(snippets)[0];\n\n\t\t\t// Reslove CSS prefix.\n\t\t\tlet prefix = '', vendors = { Webkit: 'webkit', Moz: '', O: 'o' };\n\t\t\tfor (let vendor in vendors) {\n\t\t\t\tif (desktop.style[vendor + 'TransitionProperty'] === undefined)\n\t\t\t\t\tcontinue;\n\t\t\t\tprefix = '-' + vendor.toLowerCase() + '-';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tattrs.prefix = prefix;\n\n\t\t\t// Initialize interaction context stack.\n\t\t\tlet contexts = attrs.contexts = [];\n\t\t\tcontexts.remove = function(target) {\n\t\t\t\tlet temp = this.concat();\n\t\t\t\tthis.length = 0;\n\t\t\t\tfor (let i = 0, context; context = temp[i]; ++i) {\n\t\t\t\t\tif (target === context)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tthis.push(context);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t};\n\n\t\t\tcontexts.findByUUID = function(uuid) {\n\t\t\t\tfor (let i = 0, context; context = this[i]; ++i) {\n\t\t\t\t\tif (context.uuid !== uuid)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\treturn context;\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t};\n\n\t\t\tcontexts.top = function() {\n\t\t\t\treturn this[this.length - 1];\n\t\t\t};\n\n\t\t\tattrs.active = attrs.previous = null;\n\t\t\tattrs.instances = {};\n\t\t\tattrs.maxInstanceCount = 8;\n\t\t\tattrs.paused = true;\n\t\t}\n\n\t\tpause () {\n\t\t\tlet attrs = this[$attrs], interaction = attrs.active,\n\t\t\t\tcontexts = attrs.contexts;\n\n\t\t\tif (attrs.paused)\n\t\t\t\treturn;\n\t\t\tattrs.paused = true;\n\n\t\t\tattrs.manager[attrs.$peeker].workspace.removeChild(attrs.desktop);\n\n\t\t\tif (contexts.length === 0 || !interaction)\n\t\t\t\treturn;\n\n\t\t\t// Pause active interaction.\n\t\t\tlet context = interaction[$attrs].context;\n\t\t\tinteraction.pause();\n\t\t\tlet state = {};\n\t\t\tinteraction.performSaveInstanceState(state);\n\t\t\tcontext.state = state;\n\t\t}\n\n\t\tsaveState () {\n\t\t\tlet attrs = this[$attrs], name = attrs.name, contexts = attrs.contexts;\n\t\t\treturn {name: name, contexts: contexts}\n\t\t}\n\n\t\trestoreState (state) {\n\t\t\tlet attrs = this[$attrs], contexts = attrs.contexts;\n\t\t\tcontexts.length = 0;\n\t\t\tattrs.name = state.name;\n\t\t\tArray.prototype.push.apply(contexts, state.contexts);\n\t\t}\n\n\t\tresume () {\n\t\t\tlet attrs = this[$attrs], interaction = attrs.active;\n\n\t\t\tif (!attrs.paused)\n\t\t\t\treturn;\n\t\t\tattrs.paused = false;\n\n\t\t\tattrs.manager[attrs.$peeker].workspace.appendChild(attrs.desktop);\n\n\t\t\tif (interaction) {\n\t\t\t\tinteraction.resume();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setBusy(true);\n\t\t\tthis.instantiateActivedInteraction();\n\t\t}\n\n\t\tdestroy () {\n\t\t\tlet attrs = this[$attrs], contexts = attrs.contexts,\n\t\t\t\tinstances = attrs.instances;\n\t\t\tfor (let i = contexts.length - 1, context; context = contexts[i]; --i) {\n\t\t\t\tlet interaction = instances[context.uuid];\n\t\t\t\tif (!interaction)\n\t\t\t\t\tcontinue;\n\t\t\t\tinteraction.destroy();\n\t\t\t\tdelete instances[context.uuid];\n\t\t\t}\n\t\t\tcontexts.length = 0;\n\t\t}\n\n\t\tstartInteraction (parent, request, target, extra) {\n\t\t\tthis.setBusy(true);\n\t\t\tif (\"undefined\" != typeof extra)\n\t\t\t\textra = JSON.parse(JSON.stringify(extra));\n\t\t\tsetTimeout(this.performStartInteraction.bind(this, parent, request, target, extra));\n\t\t}\n\n\t\tfinishInteraction (uuid) {\n\t\t\tthis.setBusy(true);\n\t\t\tsetTimeout(this.performFinishInteraction.bind(this, uuid));\n\t\t}\n\n\t\tsetBusy (busy) {\n\t\t\tthis[$attrs].manager.setBusy(busy);\n\t\t}\n\n\t\tsetLoading (loading) {\n\t\t\tthis[$attrs].manager.setLoading(loading);\n\t\t}\n\n\t\tperformStartInteraction (parent, request, target, extra) {\n\t\t\tlet attrs = this[$attrs], interaction = attrs.active,\n\t\t\t\tcontexts = attrs.contexts,\n\t\t\t\tinstances = attrs.instances;\n\n\t\t\t// Deactive actived interaction.\n\t\t\tif (interaction) {\n\t\t\t\tlet context = contexts.top(), state = {};\n\n\t\t\t\tinteraction.pause();\n\t\t\t\tinteraction.performSaveInstanceState(state);\n\t\t\t\tcontext.state = state;\n\n\t\t\t\tattrs.previous = interaction;\n\t\t\t\tattrs.active = null;\n\t\t\t}\n\n\t\t\t// create context for new interaction.\n\t\t\tlet context = {\n\t\t\t\tuuid : UUID.randomUUID(),\n\t\t\t\tparent : parent,\n\t\t\t\trequestCode : request,\n\t\t\t\tname : target,\n\t\t\t\textra : extra,\n\t\t\t\tresultCode : 'CANCEL',\n\t\t\t\tresultData : undefined,\n\t\t\t\tpendingResults : []\n\t\t\t};\n\n\t\t\t// Clean up instances if the stack size is to large.\n\t\t\tif (contexts.length >= attrs.maxInstanceCount) {\n\t\t\t\tlet excess = contexts[contexts.length - attrs.maxInstanceCount];\n\t\t\t\tlet instance = instances[excess.uuid];\n\t\t\t\tif (instance)\n\t\t\t\t\tinteraction.destroy();\n\t\t\t\tdelete instances[excess.uuid];\n\t\t\t}\n\n\t\t\t// Push context to the stack and instantizte it.\n\t\t\tcontexts.push(context);\n\t\t\tattrs.animation = 'start';\n\t\t\tthis.instantiateActivedInteraction();\n\t\t}\n\n\t\tperformFinishInteraction (uuid) {\n\t\t\tlet attrs = this[$attrs], interaction = attrs.active,\n\t\t\t\tcontexts = attrs.contexts,\n\t\t\t\tinstances = attrs.instances;\n\n\t\t\tlet context = contexts.findByUUID(uuid);\n\t\t\tif (!context) {\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet parent = contexts.findByUUID(context.parent);\n\t\t\tif (parent) {\n\t\t\t\tlet result = {\n\t\t\t\t\trequest : context.requestCode,\n\t\t\t\t\tresult : context.resultCode,\n\t\t\t\t\tdata : context.resultData,\n\t\t\t\t};\n\t\t\t\tparent.pendingResults.push(result);\n\t\t\t}\n\n\t\t\tdelete instances[context.uuid];\n\n\t\t\tif (context !== contexts.top()) {\n\t\t\t\tcontexts.remove(context);\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tinteraction.pause();\n\t\t\tinteraction.destroy();\n\n\t\t\tattrs.previous = interaction;\n\t\t\tattrs.active = null;\n\t\t\tcontexts.remove(context);\n\n\t\t\tif (contexts.length == 0) {\n\t\t\t\tattrs.manager.finishTask(this.name);\n\t\t\t\tattrs.desktop.innerHTML = '';\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tattrs.animation = 'finish';\n\t\t\tthis.instantiateActivedInteraction();\n\t\t}\n\n\t\tinstantiateActivedInteraction () {\n\t\t\t// We are going to instantiate context which at the top of the stack.\n\t\t\tlet attrs = this[$attrs], contexts = attrs.contexts,\n\t\t\t\tinstances = attrs.instances;\n\t\t\tlet context = contexts.top();\n\n\t\t\tif (!context || this[$attrs].paused) {\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// lookup instance from the instance map.\n\t\t\tlet interaction = instances[context.uuid];\n\n\t\t\tif (interaction) {\n\t\t\t\t// instance exists, we don't need to restore state\n\t\t\t\t// just delete saved state.\n\t\t\t\tdelete context.state;\n\t\t\t\tthis.doInteractionCreated(interaction);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// We are going to do some async jobs, set the loading flag to true.\n\t\t\tthis.setLoading(true);\n\n\t\t\t// Async load interaction class\n\t\t\tlet require = window.require;\n\t\t\trequire([context.name], this.doInteractionClassLoaded.bind(\n\t\t\t\tthis, context\n\t\t\t\t));\n\t\t}\n\n\t\tdoInteractionClassLoaded (context, clazz) {\n\t\t\tlet attrs = this[$attrs], contexts = attrs.contexts;\n\n\t\t\tif (context != contexts.top()) {\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet interaction = new clazz.default(this, $attrs, context);\n\n\t\t\tinteraction.create(context.state);\n\t\t\tthis.doInteractionCreated(interaction);\n\t\t}\n\n\t\tdoInteractionCreated (interaction) {\n\t\t\tlet attrs = this[$attrs], contexts = attrs.contexts,\n\t\t\t\tinstances = attrs.instances;\n\t\t\tlet context = interaction[$attrs].context;\n\n\t\t\tif (context != contexts.top()) {\n\t\t\t\tthis.setBusy(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tinstances[context.uuid] = interaction;\n\t\t\tthis.setLoading(false);\n\n\t\t\tif (context.state)\n\t\t\t\tinteraction.performRestoreInstanceState(context.state);\n\t\t\tdelete context.state;\n\n\t\t\tlet root = interaction[$attrs].root;\n\t\t\tif (!root)\n\t\t\t\tthrow new Error('Please call setContent() during onCreate().');\n\n\t\t\tlet EASINGI = 'cubic-bezier(.4,1,.6,1)',\n\t\t\t\tEASINGO = 'cubic-bezier(.4,0,.6,0)';\n\n\t\t\tlet upper, lower, outer, ueasing, leasing, uanim, lanim, anim;\n\n\t\t\t// Reslove animation configuration.\n\t\t\tswitch (attrs.animation) {\n\t\t\tcase 'start':\n\t\t\t\tupper = interaction;\n\t\t\t\tlower = attrs.previous;\n\t\t\t\touter = lower;\n\t\t\t\tanim = 'staple-it-' + (upper[$attrs].root.dataset.anim || 'default');\n\t\t\t\tuanim = anim + '-enter';\n\t\t\t\tueasing = EASINGI;\n\t\t\t\tlanim = anim + '-push';\n\t\t\t\tleasing = EASINGO;\n\t\t\t\tattrs.desktop.appendChild(root);\n\t\t\t\tbreak;\n\t\t\tcase 'finish':\n\t\t\t\tupper = attrs.previous;\n\t\t\t\tlower = interaction;\n\t\t\t\touter = upper;\n\t\t\t\tanim = 'staple-it-' + (upper[$attrs].root.dataset.anim || 'default');\n\t\t\t\tuanim = anim + '-leave';\n\t\t\t\tueasing = EASINGO;\n\t\t\t\tlanim = anim + '-pop';\n\t\t\t\tleasing = EASINGI;\n\t\t\t\tattrs.desktop.insertBefore(root, upper ? upper[$attrs].root : undefined);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tupper = interaction;\n\t\t\t\tattrs.desktop.appendChild(root);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// handle pending results.\n\t\t\tlet results = context.pendingResults;\n\t\t\t// fatch and append external result.\n\t\t\tlet key = 'staple:///results/' + context.uuid;\n\t\t\tlet externalResult = sessionStorage[key];\n\t\t\tif (externalResult)\n\t\t\t\tresults.push(externalResult.evalJSON());\n\t\t\tsessionStorage.removeItem(key);\n\t\t\t// dispatch pending results.\n\t\t\tfor (let i = 0, r; r = results[i]; ++i)\n\t\t\t\tinteraction.onInteractionResult(r.request, r.result, r.data);\n\t\t\tresults.length = 0;\n\n\t\t\tinteraction.resume();\n\n\t\t\tlet upperCss = upper ? upper[$attrs].root.style.context : '';\n\t\t\tlet lowerCss = lower ? lower[$attrs].root.style.context : '';\n\n\t\t\tfunction onAnimationComplete () {\n\t\t\t\tif (outer)\n\t\t\t\t\tattrs.desktop.removeChild(outer[$attrs].root);\n\t\t\t\tif (upper)\n\t\t\t\t\tupper[$attrs].root.style.cssText = upperCss;\n\t\t\t\tif (lower)\n\t\t\t\t\tlower[$attrs].root.style.cssText = lowerCss;\n\t\t\t\tthis.setBusy(false);\n\t\t\t}\n\n\t\t\tif (anim && attrs.previous) {\n\t\t\t\tif (upper)\n\t\t\t\t\tupper[$attrs].root.style.cssText += ';'\n\t\t\t\t\t\t+ attrs.prefix + 'animation:' + uanim + ' .2s ' + ueasing + ';'\n\t\t\t\t\t\t+ attrs.prefix + 'animation-fill-mode: both' + ';';\n\t\t\t\tif (lower)\n\t\t\t\t\tlower[$attrs].root.style.cssText += ';'\n\t\t\t\t\t\t+ attrs.prefix + 'animation:' + lanim + ' .2s ' + leasing + ';'\n\t\t\t\t\t\t+ attrs.prefix + 'animation-fill-mode: both' + ';';\n\t\t\t\tsetTimeout(onAnimationComplete.bind(this), 300);\n\t\t\t} else {\n\t\t\t\tonAnimationComplete.apply(this);\n\t\t\t}\n\n\t\t\tattrs.active = interaction;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Task', {value: Task});\n\tObject.defineProperty(exports, 'default', {value: Task});\n\n});\n","/*\n * Copyright (C) 2016 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/toast.js\n * @author\tEric.Tsai\n *\n */\n\n// Base class of staple toast.\ndefine('staple/toast', function (require, exports, module) {\n\n\tconst PeriodicalTask = require('staple/periodical-task').default;\n\tconst HTMLParser = require('staple/html-parser').default;\n\n\tconst $attrs = Symbol();\n\n\tclass Toast {\n\n\t\tconstructor (interaction, content, duration) {\n\t\t\tlet attrs = this[$attrs] = {};\n\n\t\t\tduration = (duration == 'long') ? 3800 : 1800;\n\n\t\t\tattrs.fadeinTask = new PeriodicalTask(100, false);\n\t\t\tattrs.fadeinTask.run = () => {\n\t\t\t\tthis[$attrs].frame.classList.add('staple-active');\n\t\t\t};\n\n\t\t\tattrs.fadeoutTask = new PeriodicalTask(duration, false);\n\t\t\tattrs.fadeoutTask.run = () => {\n\t\t\t\tthis[$attrs].frame.classList.remove('staple-active');\n\t\t\t\tthis[$attrs].dismissTask.start();\n\t\t\t};\n\n\t\t\tattrs.dismissTask = new PeriodicalTask(300, false);\n\t\t\tattrs.dismissTask.run = this.dismiss.bind(this);\n\n\t\t\tif (content)\n\t\t\t\tthis.setContent(content);\n\n\t\t\tattrs.overlayManager = interaction.overlayManager;\n\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tsetContent (content) {\n\t\t\tlet attrs = this[$attrs];\n\t\t\tif (attrs.frame)\n\t\t\t\tthrow new Error('Cannot setContent for a toast after it is initialized');\n\n\t\t\tif (Object.prototype.toString.call(content) === '[object String]') {\n\t\t\t\tlet elements = HTMLParser.parse(content);\n\t\t\t\tif (elements.length != 1)\n\t\t\t\t\tthrow new Error('Invalid content');\n\t\t\t\tcontent = elements[0];\n\t\t\t}\n\n\t\t\tif (!(content instanceof HTMLElement))\n\t\t\t\tthrow new Error('Content must be an HTML element');\n\n\t\t\tcontent.addEventListener('click', evt => {\n\t\t\t\tthis.show();\n\t\t\t\tevt.stopPropagation();\n\t\t\t});\n\t\t\tcontent.classList.add('staple-toast');\n\t\t\tattrs.frame = this[$attrs].root = content;\n\t\t\tattrs.frame.handleBackPressed = this.handleBackPressed.bind(this);\n\t\t}\n\n\t\tselect (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn [ root ];\n\t\t\treturn $A(root.querySelectorAll(selector));\n\t\t}\n\n\t\tselectOne (selector) {\n\t\t\tlet root = this[$attrs].root;\n\t\t\tif (selector === '$root')\n\t\t\t\treturn root;\n\t\t\treturn root.querySelector(selector);\n\t\t}\n\n\t\tshow () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing) {\n\t\t\t\tattrs.showing = true;\n\t\t\t\tattrs.overlayManager.attach(attrs.frame);\n\t\t\t}\n\n\t\t\tattrs.fadeinTask.start(false);\n\t\t\tattrs.fadeoutTask.start(true);\n\t\t\tattrs.dismissTask.stop();\n\t\t}\n\n\t\tdismiss () {\n\t\t\tlet attrs = this[$attrs];\n\n\t\t\tif (!attrs.showing)\n\t\t\t\treturn;\n\n\t\t\tattrs.fadeoutTask.stop();\n\t\t\tattrs.fadeinTask.stop();\n\t\t\tattrs.dismissTask.stop();\n\t\t\tattrs.overlayManager.detach(attrs.frame);\n\t\t\tattrs.showing = false;\n\t\t}\n\n\t\tget showing () {\n\t\t\treturn this[$attrs].showing;\n\t\t}\n\n\t\thandleBackPressed () {\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'Toast', {value: Toast});\n\tObject.defineProperty(exports, 'default', {value: Toast});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/uuid.js\n * @author\tEric.Tsai\n *\n */\n\n// UUID generator.\ndefine('staple/uuid', function (require, exports, module) {\n\n\tconst CHARS = \"0123456789ABCDEF\".split(\"\");\n\n\tclass UUID {\n\n\t\tconstructor () {\n\t\t\tthrow new Error('This class can not be initialized');\n\t\t}\n\n\t}\n\n\tUUID.randomUUID = function () {\n\t\tlet chars = CHARS, uuid = new Array(36), rnd=0, r;\n\t\tfor (let i = 0; i < 36; i++) {\n\t\t\tif (i==8 || i==13 || i==18 || i==23) {\n\t\t\t\tuuid[i] = \"-\";\n\t\t\t} else if (i==14) {\n\t\t\t\tuuid[i] = \"4\";\n\t\t\t} else {\n\t\t\t\tif (rnd <= 0x02) rnd = 0x2000000 + (Math.random()*0x1000000)|0;\n\t\t\t\tr = rnd & 0xf;\n\t\t\t\trnd = rnd >> 4;\n\t\t\t\tuuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n\t\t\t}\n\t\t}\n\t\treturn uuid.join(\"\");\n\t};\n\n\tObject.defineProperty(exports, '__esModule', {value: true});\n\tObject.defineProperty(exports, 'UUID', {value: UUID});\n\tObject.defineProperty(exports, 'default', {value: UUID});\n\n});\n","/*\n * Copyright (C) 2018 iWARES Solution Provider\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n/**\n * @file\tcore/noumenon.js\n * @author\tEric.Tsai\n *\n */\n\n\n(function () {\n\n\n// Staple object.\nconst staple = {value: '1.2.0'};\n\n// Preprocess all query parameters.\nlet args = JSON.parse(window.sessionStorage['staple:///args'] || '{}');\n\nlet search = window.location.search;\nlet interaction, extra, bust;\n\nif (search) {\n\tlet fields = search.substr(1).split('&');\n\targs = { };\n\n\tfor (let i = 0, field; field = fields[i]; ++i) {\n\t\tlet kv = field.split('=');\n\t\tswitch (kv[0]) {\n\t\tcase '_int':\n\t\t\tinteraction = decodeURIComponent(kv[1]);\n\t\t\tbreak;\n\t\tcase '_ext':\n\t\t\textra = decodeURIComponent(kv[1]);\n\t\t\tbreak;\n\t\tcase '_bust':\n\t\t\tbust = decodeURIComponent(kv[1]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\targs[kv[0]] = decodeURIComponent(kv[1]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\twindow.sessionStorage['staple:///args'] = JSON.stringify(args);\n}\n\n// Collect all meta data.\nlet metaTags = window.document.head.querySelectorAll(\"meta\");\nlet meta = { };\nfor (let i = 0, tag; tag = metaTags[i]; ++i)\n\tmeta[tag.name] = tag.content;\nwindow.document.head.meta = meta;\n\n// Build a query string which will be used to bust the http cache.\nbust = window.sessionStorage['staple:///bust'] || bust || meta['version-code'];\nif (bust == 'timestamp')\n\tbust = (new Date()).getTime();\nwindow.sessionStorage['staple:///bust'] = bust || '';\n\n// Compute root path.\nlet mainScript = window.document.querySelector('script[data-main]');\nlet scriptPath = mainScript.dataset.main;\nlet base = mainScript.dataset.base;\nlet home = mainScript.dataset.home;\nlet task = mainScript.dataset.task;\nlet stapleRoot = scriptPath.substr(0, scriptPath.lastIndexOf('/') + 1);\n\nrequirejs.config({\n\t'baseUrl': base || '',\n\t'urlArgs': bust ? '_bust=' + bust : undefined,\n\t'waitSeconds': 15,\n\t'paths': {\n\t\t'staple': stapleRoot + 'modules'\n\t},\n});\n\n\n// Entry of the staple framework.\nrequire(['application', 'staple/application'], function (subclass, baseclass) {\n\n\tconst Application = subclass.default;\n\tconst BaseClass = baseclass.default;\n\tconst application = staple.application = new Application();\n\n\tif (!application instanceof BaseClass)\n\t\tthrow new Error(subclass.name + ' is not a subclass of \"staple/application\"');\n\n\tObject.defineProperty(application, 'namespace', {value: window.location.pathname});\n\tObject.defineProperty(application, 'title', {value: window.document.title});\n\tObject.defineProperty(application, 'meta', {value: window.document.head.meta});\n\tObject.defineProperty(application, 'args', {value: args});\n\n\treturn application.start(home, interaction, task, extra);\n\n});\n\n\n// Export staple as a global variable.\nwindow.staple = staple;\n\n\n})();\n"]}